import requests
import subprocess
import tkinter as tk

def speak_text():
     print("🟢 Button wurde gedrückt") 
    text = text_input.get("1.0", tk.END).strip()
    print("🧠 Text eingegeben:", text)
    
    if not text:
        print("⚠️ Kein Text eingegeben.")
        return

    try:
        response = requests.post("http://127.0.0.1:6066/api/speak", json={"text": text})
        print("🔁 API Antwortstatus:", response.status_code)
        if response.status_code == 200:
            with open("narion.mp3", "wb") as f:
                f.write(response.content)
            print("🎧 Audio gespeichert, spiele ab...")
            subprocess.call(["afplay", "narion.mp3"])
        else:
            print("❌ Fehler vom Server:", response.text)
    except Exception as e:
        print("💥 Ausnahme:", str(e))

# GUI
window = tk.Tk()
window.title("Narion Debug-GUI")
window.geometry("400x250")

tk.Label(window, text="Sag was:").pack(pady=10)
text_input = tk.Text(window, height=4, width=40)
text_input.pack()
button = tk.Button(window, text="Sprechen 🗣️")
button.pack(pady=10)
button.config(command=speak_text)


window.mainloop()
